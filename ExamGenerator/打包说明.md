# 打包说明

## 使用 PyInstaller 打包为 Windows EXE

### 1. 安装 PyInstaller
```bash
pip install pyinstaller
```

### 2. 打包命令
```bash
pyinstaller --onefile --windowed --name="电子试卷生成工具" --icon=icon.ico exam_generator.py
```

参数说明：
- `--onefile`: 打包成单个exe文件
- `--windowed`: 不显示命令行窗口
- `--name`: 指定生成的exe文件名
- `--icon`: 指定图标文件（需要自行准备）

### 3. 打包后的文件
生成的exe文件位于 `dist/` 目录下。

### 4. 分发准备
将以下文件/文件夹放在同一目录：
```
ExamGenerator/
├── 电子试卷生成工具.exe
├── static_template/           # 必需
├── templates/                 # 必需
├── README.md
├── 快速入门.md
├── 用户手册.md
└── examples/
    └── 示例项目.json
```

### 5. 测试
1. 双击运行exe文件
2. 创建一道测试题目
3. 生成试卷到临时目录
4. 检查生成的文件是否完整

## 使用 Auto-py-to-exe（推荐，可视化）

### 1. 安装
```bash
pip install auto-py-to-exe
```

### 2. 启动
```bash
auto-py-to-exe
```

### 3. 配置
- Script Location: 选择 exam_generator.py
- Onefile: One File
- Console Window: Window Based
- Icon: （可选）选择图标文件
- Additional Files: 添加 static_template 和 templates 文件夹

### 4. 转换
点击 "CONVERT .PY TO .EXE" 按钮

## 注意事项

1. **文件依赖**
   - html_template.py 必须在同一目录
   - static_template 文件夹必须完整
   - templates 文件夹（如有）需包含

2. **相对路径问题**
   打包后需要使用相对路径或资源文件路径：
   ```python
   # 修改代码中的路径获取方式
   if getattr(sys, 'frozen', False):
       # 打包后的路径
       base_path = sys._MEIPASS
   else:
       # 开发时的路径
       base_path = os.path.dirname(__file__)
   ```

3. **静态资源**
   使用 PyInstaller 的 --add-data 参数包含资源：
   ```bash
   --add-data "static_template;static_template"
   --add-data "templates;templates"
   ```

4. **体积优化**
   - 使用 --onefile 会增大体积但方便分发
   - 使用 --onedir 体积小但文件多

5. **杀毒软件误报**
   打包的exe可能被杀毒软件误报，可以：
   - 添加数字签名
   - 提交到杀软厂商白名单
   - 提供源码和说明

## 完整打包脚本（build.bat）

```batch
@echo off
echo 正在打包电子试卷生成工具...
echo.

pyinstaller --clean ^
    --onefile ^
    --windowed ^
    --name="电子试卷生成工具" ^
    --add-data "static_template;static_template" ^
    --add-data "templates;templates" ^
    exam_generator.py

echo.
echo 打包完成！文件位于 dist 目录
pause
```

## 分发清单

打包完成后，创建发布包应包含：

```
ExamGenerator_v1.0/
├── 电子试卷生成工具.exe       # 主程序
├── static_template/           # 静态资源模板
├── templates/                 # 题目模板
├── README.md                  # 说明文档
├── 快速入门.md                # 快速入门
├── 用户手册.md                # 详细手册
└── examples/                  # 示例文件
    └── 示例项目.json
```

压缩为 ZIP 文件后即可分发。
