# 电子试卷生成工具 v1.0

## 📋 简介

这是一个专门为电子考试系统设计的试卷生成工具，可以快速创建各种类型的考试题目，并生成符合系统要求的HTML试卷文件。

**支持的题型：**
- ✅ 单选题（带代码示例支持）
- ✅ 选择填空题
- ✅ C语言编程操作题
- ✅ Photoshop图形处理操作题

## 🎯 核心功能

### 1. 可视化题目编辑
- 📝 直观的GUI界面，无需手写HTML
- 🔄 支持题目的增删改查、排序
- 💾 项目保存/加载功能
- 📂 导入现有试卷

### 2. 完整的试卷配置
- 🏷️ 题目分组管理
- 📖 考试说明自定义
- 🎨 自动生成配置文件（.dat）
- 📊 题型自动识别

### 3. 一键生成
- 🚀 自动生成所有HTML文件
- 📁 自动复制静态资源
- 🖼️ 自动处理素材文件
- ✅ 完全兼容现有考试系统

## 📦 安装说明

### Windows 系统

1. **安装Python环境**
   - 下载并安装 Python 3.8+ (https://www.python.org/)
   - 安装时勾选"Add Python to PATH"

2. **安装依赖库**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   python exam_generator.py
   ```

### 或使用打包版本（推荐）

如果提供了exe打包版本，直接双击 `ExamGenerator.exe` 即可运行。

## 🎓 使用教程

### 第一步：创建题目

#### 单选题
1. 选择题目类型："单选题"
2. 填写题目编号（如：1）
3. 输入题干内容
4. 填写 A、B、C、D 四个选项
5. （可选）在代码区域添加代码示例
6. 点击"添加题目"

**示例：**
```
题目编号: 1
题干: C 语言中，正确的用户标识符是（    ）
选项A: b+a
选项B: 2x
选项C: &c
选项D: temp
```

#### 选择填空题
1. 选择题目类型："选择填空题"
2. 填写题目编号
3. 输入题干（包含【序号】占位符）
4. 填写填空数量和每空分值
5. 在代码区域输入带空白的代码
6. 在备选项区域输入选项列表
7. 点击"添加题目"

**示例：**
```
题干: 根据程序功能描述，从备选项中选择正确的选项填入【序号】处...
填空数量: 5
每空分值: 2
代码区域: 
  【1】 ch[80];
  gets(【2】);
备选项:
  A、char
  B、ch
  C、\0
```

#### C语言操作题
1. 选择题目类型："C语言操作题"
2. 填写题干（程序功能描述）
3. 点击"浏览"选择素材文件夹（包含prog.c等）
4. 点击"添加题目"

**素材文件夹应包含：**
- prog.c（C语言源文件）
- 可选的示例图片（运行结果截图）

#### Photoshop操作题
1. 选择题目类型："PS操作题"
2. 填写题干
3. 选择素材文件夹（包含素材图片）
4. 选择样图文件
5. 点击"添加题目"

**素材文件夹应包含：**
- 各种素材图片
- 作品.psd 文件（可以是空白的）

### 第二步：设置题目分组

在右侧"试卷设置"面板：

1. 输入分组名称，如："一、C语言程序设计单选题"
2. 输入该组题目数量，如："5"
3. 点击"添加分组"
4. 重复以上步骤添加更多分组

**示例分组：**
```
一、C语言程序设计单选题----5
二、C语言程序设计填空题----1
三、C语言程序设计编程题----1
四、图形图像处理----1
```

### 第三步：编写考试说明

在"考试说明"文本框中输入考试须知：
```
1.考试时长：60分钟。
2.考试模块：C语言程序设计、图形图像设计
3.试题总分：230分
4.考试形式：登录考试系统答题
5.注意事项：
   (1)随时保存操作过程的文件...
   (2)考生不得自行关闭或重启系统...
```

### 第四步：生成试卷

1. 点击"📁 选择输出目录"，选择生成位置
2. 点击"🚀 生成试卷"
3. 等待生成完成
4. 打开输出目录查看结果

## 📁 生成的文件结构

```
output/
├── 01.html                  # 第1题HTML
├── 02.html                  # 第2题HTML
├── ...
├── 06.html                  # 填空题
├── 06-config.dat            # 填空题配置
├── 07.html                  # C语言操作题
├── 07/                      # C语言素材文件夹
│   └── prog.c
├── 07-config.dat            # C语言题配置
├── 08.html                  # PS操作题
├── 08/                      # PS素材文件夹
│   ├── 样图.jpg
│   ├── 作品.psd
│   └── 素材/
├── 08-config.dat            # PS题配置
├── groups-info.dat          # 分组信息
├── question-type.dat        # 题型列表
├── tips.txt                 # 考试说明
└── static/                  # 静态资源
    ├── bootstrap.min.css
    ├── jquery.min.js
    └── ...
```

## 🔧 配置文件说明

### groups-info.dat
格式：`分组名----题目数量`
```
一、C语言程序设计单选题----5
二、C语言程序设计填空题----1
```

### question-type.dat
每行对应一道题的类型
```
single   # 单选题
single
choice   # 选择填空题
file     # 操作题
```

### XX-config.dat
操作题的配置文件

**选择填空题（06-config.dat）：**
```
5        # 填空数量
2        # 每空分值
```

**C语言题（07-config.dat）：**
```
prog.c   # 文件名
```

**PS题（08-config.dat）：**
```
样图.jpg
作品.psd
素材\图片1.png
素材\图片2.png
```

## 💡 高级功能

### 题目排序
- 使用"▲ 上移"和"▼ 下移"按钮调整题目顺序
- 顺序影响最终生成的文件编号

### 编辑已有题目
1. 在题目列表中点击选择题目
2. 题目内容自动加载到编辑区
3. 修改后点击"更新题目"

### 保存/加载项目
- **保存项目**：将所有题目、分组、说明保存为JSON文件
- **加载项目**：从JSON文件恢复之前的工作
- 便于多次编辑和版本管理

### 导入现有试卷
- 可以导入已有的试卷目录
- 自动识别题型和分组
- 适用于修改和更新现有试卷

## ⚠️ 注意事项

1. **文件编码**：所有文件使用UTF-8编码，确保中文正常显示
2. **文件命名**：生成的HTML文件按顺序命名（01.html, 02.html...）
3. **素材文件**：
   - C语言题需要提供prog.c模板文件
   - PS题需要提供素材文件夹和样图
4. **代码格式**：
   - HTML特殊字符会自动转义
   - 保留代码的缩进和换行
5. **题目编号**：
   - 题干中的编号与文件名可以不同
   - 建议保持一致以便管理

## 🐛 故障排除

### 问题1：程序无法启动
- 检查Python版本是否为3.8+
- 确认已安装所有依赖：`pip install -r requirements.txt`

### 问题2：生成的试卷显示乱码
- 确保所有输入内容使用中文UTF-8编码
- 检查static文件夹是否正确复制

### 问题3：操作题素材未复制
- 确认素材文件夹路径正确
- 检查文件夹权限
- 使用绝对路径而不是相对路径

### 问题4：考试系统无法加载试卷
- 检查文件结构是否完整
- 确认.dat配置文件格式正确
- 验证HTML文件编码为UTF-8

## 📞 技术支持

如有问题，请检查：
1. 本README文档
2. 生成的日志文件
3. 查看示例试卷的文件结构

## 📝 更新日志

### v1.0 (2025-10-22)
- ✅ 首次发布
- ✅ 支持4种题型
- ✅ GUI界面
- ✅ 项目保存/加载
- ✅ 试卷导入功能

## 📄 许可证

本工具仅供学习和内部使用，未经授权不得商业使用。

---

**开发者**: AI Assistant  
**版本**: 1.0  
**更新日期**: 2025-10-22
